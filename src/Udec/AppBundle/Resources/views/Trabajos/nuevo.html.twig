{% extends '::index.html.twig' %}
{% block contenido %}
    <div class="col-lg-12">
        <h1 class="page-header">Nuevo Trabajo</h1>
    </div>
    <div class="row">
        <div class="col-lg-8">
            <form role="form">
                <div class="form-group">
                    <label>Título del Trabajo:</label>
                    <input id="dtitulo" name="dtitulo" class="form-control">
                    <p class="help-block">Máximo 200 caracteres</p>
                </div>
                <div class="form-group">
                    <label>Concepto:</label>
                    <input id="dconcepto" name="dconcepto" class="form-control">
                    <p class="help-block">Máximo 50 caracteres</p>
                </div>
                <div class="form-group col-lg-4">
                    <label>Fecha Graduación:</label>
                    <input id="dconcepto" name="dconcepto" class="form-control">
                    <p class="help-block">AAAA-MM-DD</p>
                </div>
                <div class="form-group col-lg-3">
                    <label>Carrera:</label>
                    <select class="form-control">
                        {% for carrera in carreras %}
                            <option value="{{ carrera.idCarrera }}">{{ carrera.nombreCarrera }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group col-lg-3">
                    <label>Clasificación:</label>
                    <select class="form-control">
                        {% for infoc in clasificacion %}
                            <option value="{{ infoc.id }}">{{ infoc.nombre }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group col-lg-12">
                    <label>Autores:</label>
                </div>
                <div id="autoresAgregados" class="form-group col-lg-12"></div>
                <div class="col-lg-12">
                    <div class="form-group input-group">
                        <input id="textAutorTrabajo" name="textAutorTrabajo" type="text" class="form-control" placeholder="Buscar autores del trabajo">
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="button" onclick="accion.buscarAutor()">
                                <i class="fa fa-search"></i>
                            </button>
                        </span>
                    </div>
                    <div id="resultAutores">
                        
                    </div>
                </div>
                <div class="form-group col-lg-12">
                    <label>Asesor:</label>
                </div>
                <div class="col-lg-12">
                    <div class="form-group input-group">
                        <input id="textAsesorTrabajo" name="textAsesorTrabajo" type="text" class="form-control" placeholder="Buscar autores del trabajo">
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="button"><i class="fa fa-search"></i>
                            </button>
                        </span>
                    </div>
                </div>
            </form>
        </div>
    </div>
{% endblock %}

{% block scriptModulo %}
    <script>
        var accion = {
            autores:{},
            buscar: function(){
                $('#areaContenido').html('Buscando...')
                $('#areaContenido').load('{{ path("udec_app_trabajos_buscar") }}',{acc:'buscar',txtkey:$('#buscador').val()});
            },
            buscarAutor: function(){
                var buscar = $('#textAutorTrabajo').val();
                $('#resultAutores').html('Buscando...');
                $('#resultAutores').load('{{ path("udec_app_personas_buscar") }}',{acc:'buscarAutor',texto:buscar});
            },
            agregarAutor: function(idPersona){
                accion.autores['id'+idPersona]=idPersona;
                var htmlPersona = $('#infoItemAutor'+idPersona).val();
                $('#autoresAgregados').append('[<i class="fa fa-user"></i> '+htmlPersona+'] ');
                $('#resultAutores').html('');
                console.log(accion.autores);
            }
        };
        $('#buscador').keypress(function(e){   
            if(e.which == 13){      
                accion.buscar();      
            }   
        });
    </script>
{% endblock %}